# STRIDE анализ угроз

## Таблица STRIDE

| Поток/Элемент | Угроза (S/T/R/I/D/E) | Описание угрозы | Контроль | Ссылка на NFR | Проверка/Артефакт |
|---------------|----------------------|-----------------|----------|---------------|-------------------|
| F1: POST /auth/login | S (Spoofing) | Злоумышленник может подделать запрос логина от имени другого пользователя | Валидация входных данных, проверка формата email | NFR-03 | Тест: проверка валидации email |
| F1: POST /auth/login | T (Tampering) | Злоумышленник может изменить пароль в запросе или перехватить его | HTTPS, валидация данных, хеширование паролей | NFR-03, NFR-05 | Тест: проверка хеширования пароля |
| F1: POST /auth/login | D (Denial of Service) | Злоумышленник может отправить множество запросов на логин, перегрузив сервер | Rate limiting на endpoint логина | NFR-06 | Тест: проверка блокировки после 5 попыток |
| F2-F5: API запросы | S (Spoofing) | Злоумышленник может подделать JWT токен или использовать чужой токен | Проверка подписи JWT, валидация токена | NFR-10 | Тест: проверка невалидного токена |
| F2-F5: API запросы | T (Tampering) | Злоумышленник может изменить данные в запросе (например, deck_id для доступа к чужой колоде) | Валидация входных данных, проверка owner_id | NFR-02, NFR-03 | Тест: попытка доступа к чужой колоде (IDOR) |
| F6: Проверка токена | R (Repudiation) | Пользователь может отрицать, что отправлял запрос, если нет логов | Логирование всех запросов с request_id | NFR-08 | Тест: проверка наличия логов запросов |
| F8, F10: Создание ресурсов | I (Information Disclosure) | Злоумышленник может получить информацию о структуре БД из ошибок | Единый формат ошибок, без stack trace | NFR-04 | Тест: проверка формата ошибок |
| F11-F16: Запросы к БД | T (Tampering) | Злоумышленник может внедрить SQL-код через входные данные | Валидация данных, параметризованные запросы | NFR-03 | Тест: попытка SQL-инъекции |
| F13, F15: Запросы колод | I (Information Disclosure) | Злоумышленник может получить доступ к чужим колодам, если не проверяется owner_id | Проверка owner_id для каждого запроса | NFR-02 | Тест: попытка доступа к чужой колоде |
| Database | E (Elevation of Privilege) | Злоумышленник может получить права администратора, если не проверяется роль | Проверка роли пользователя, owner-only доступ | NFR-02 | Тест: попытка доступа с ролью user к admin-функциям |
| F26-F30: Ответы API | I (Information Disclosure) | Злоумышленник может получить внутренние детали из stack trace в ошибках | Единый формат ошибок, обработка исключений | NFR-04 | Тест: проверка отсутствия stack trace в ответах |
| Auth Service | T (Tampering) | Злоумышленник может изменить секретный ключ JWT, если он хранится в коде | Секреты в переменных окружения | NFR-10 | CI: проверка отсутствия секретов в коде |
